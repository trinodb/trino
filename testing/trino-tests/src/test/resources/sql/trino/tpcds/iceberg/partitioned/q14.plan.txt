local exchange (GATHER, SINGLE, [])
    remote exchange (GATHER, SINGLE, [])
        local exchange (GATHER, SINGLE, [])
            local exchange (REPARTITION, ROUND_ROBIN, [])
                final aggregation over (channel_gid, groupid, i_brand_id_gid, i_category_id_gid, i_class_id_gid)
                    local exchange (REPARTITION, HASH, [channel_gid, groupid, i_brand_id_gid, i_category_id_gid, i_class_id_gid])
                        remote exchange (REPARTITION, HASH, [channel_gid, groupid, i_brand_id_gid, i_category_id_gid, i_class_id_gid])
                            partial aggregation over (channel_gid, groupid, i_brand_id_gid, i_category_id_gid, i_class_id_gid)
                                local exchange (REPARTITION, ROUND_ROBIN, [])
                                    cross join:
                                        final aggregation over (i_brand_id_6, i_category_id_8, i_class_id_7)
                                            local exchange (GATHER, SINGLE, [])
                                                remote exchange (REPARTITION, HASH, [i_brand_id_6, i_category_id_8, i_class_id_7])
                                                    intermediate aggregation over (i_brand_id_6, i_category_id_8, i_class_id_7)
                                                        join (INNER, REPLICATED):
                                                            partial aggregation over (ss_item_sk)
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (ss_item_sk::EQUAL, ss_sold_date_sk::EQUAL)
                                                                        scan store_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            local exchange (GATHER, SINGLE, [])
                                                                remote exchange (REPLICATE, BROADCAST, [])
                                                                    join (INNER, PARTITIONED):
                                                                        remote exchange (REPARTITION, HASH, [i_item_sk])
                                                                            dynamic filter (i_item_sk::EQUAL)
                                                                                scan item
                                                                        final aggregation over (i_item_sk_19)
                                                                            local exchange (GATHER, SINGLE, [])
                                                                                remote exchange (REPARTITION, HASH, [i_item_sk_19])
                                                                                    partial aggregation over (i_item_sk_19)
                                                                                        join (INNER, PARTITIONED, can skip output duplicates):
                                                                                            remote exchange (REPARTITION, HASH, [i_brand_id_26, i_category_id_30, i_class_id_28])
                                                                                                dynamic filter (i_brand_id_26::EQUAL, i_category_id_30::EQUAL, i_class_id_28::EQUAL)
                                                                                                    scan item
                                                                                            final aggregation over (brand_id, category_id, class_id)
                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_84, i_category_id_88, i_class_id_86])
                                                                                                        intermediate aggregation over (i_brand_id_84, i_category_id_88, i_class_id_86)
                                                                                                            join (INNER, REPLICATED):
                                                                                                                partial aggregation over (ss_item_sk_50)
                                                                                                                    join (INNER, REPLICATED):
                                                                                                                        dynamic filter (ss_item_sk_50::EQUAL, ss_sold_date_sk_71::EQUAL)
                                                                                                                            scan store_sales
                                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                                scan date_dim
                                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                                    remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                        scan item
                                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_149, i_category_id_153, i_class_id_151])
                                                                                                        intermediate aggregation over (i_brand_id_149, i_category_id_153, i_class_id_151)
                                                                                                            join (INNER, REPLICATED):
                                                                                                                partial aggregation over (cs_item_sk)
                                                                                                                    join (INNER, REPLICATED):
                                                                                                                        dynamic filter (cs_item_sk::EQUAL, cs_sold_date_sk::EQUAL)
                                                                                                                            scan catalog_sales
                                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                                scan date_dim
                                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                                    remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                        scan item
                                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_214, i_category_id_218, i_class_id_216])
                                                                                                        intermediate aggregation over (i_brand_id_214, i_category_id_218, i_class_id_216)
                                                                                                            join (INNER, REPLICATED):
                                                                                                                partial aggregation over (ws_item_sk)
                                                                                                                    join (INNER, REPLICATED):
                                                                                                                        dynamic filter (ws_item_sk::EQUAL, ws_sold_date_sk::EQUAL)
                                                                                                                            scan web_sales
                                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                                scan date_dim
                                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                                    remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                        scan item
                                        local exchange (GATHER, SINGLE, [])
                                            remote exchange (REPLICATE, BROADCAST, [])
                                                final aggregation over ()
                                                    local exchange (GATHER, SINGLE, [])
                                                        remote exchange (GATHER, SINGLE, [])
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (ss_sold_date_sk_294::EQUAL)
                                                                        scan store_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (cs_sold_date_sk_366::EQUAL)
                                                                        scan catalog_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (ws_sold_date_sk_438::EQUAL)
                                                                        scan web_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                    cross join:
                                        final aggregation over (i_brand_id_526, i_category_id_530, i_class_id_528)
                                            local exchange (GATHER, SINGLE, [])
                                                remote exchange (REPARTITION, HASH, [i_brand_id_526, i_category_id_530, i_class_id_528])
                                                    intermediate aggregation over (i_brand_id_526, i_category_id_530, i_class_id_528)
                                                        join (INNER, REPLICATED):
                                                            partial aggregation over (cs_item_sk_494)
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (cs_item_sk_494::EQUAL, cs_sold_date_sk_513::EQUAL)
                                                                        scan catalog_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            local exchange (GATHER, SINGLE, [])
                                                                remote exchange (REPLICATE, BROADCAST, [])
                                                                    join (INNER, PARTITIONED):
                                                                        remote exchange (REPARTITION, HASH, [i_item_sk_519])
                                                                            dynamic filter (i_item_sk_519::EQUAL)
                                                                                scan item
                                                                        final aggregation over (i_item_sk_581)
                                                                            local exchange (GATHER, SINGLE, [])
                                                                                remote exchange (REPARTITION, HASH, [i_item_sk_581])
                                                                                    partial aggregation over (i_item_sk_581)
                                                                                        join (INNER, PARTITIONED, can skip output duplicates):
                                                                                            remote exchange (REPARTITION, HASH, [i_brand_id_588, i_category_id_592, i_class_id_590])
                                                                                                dynamic filter (i_brand_id_588::EQUAL, i_category_id_592::EQUAL, i_class_id_590::EQUAL)
                                                                                                    scan item
                                                                                            final aggregation over (brand_id_608, category_id_610, class_id_609)
                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_649, i_category_id_653, i_class_id_651])
                                                                                                        intermediate aggregation over (i_brand_id_649, i_category_id_653, i_class_id_651)
                                                                                                            join (INNER, REPLICATED):
                                                                                                                partial aggregation over (ss_item_sk_615)
                                                                                                                    join (INNER, REPLICATED):
                                                                                                                        dynamic filter (ss_item_sk_615::EQUAL, ss_sold_date_sk_636::EQUAL)
                                                                                                                            scan store_sales
                                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                                scan date_dim
                                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                                    remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                        scan item
                                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_748, i_category_id_752, i_class_id_750])
                                                                                                        intermediate aggregation over (i_brand_id_748, i_category_id_752, i_class_id_750)
                                                                                                            join (INNER, REPLICATED):
                                                                                                                partial aggregation over (cs_item_sk_716)
                                                                                                                    join (INNER, REPLICATED):
                                                                                                                        dynamic filter (cs_item_sk_716::EQUAL, cs_sold_date_sk_735::EQUAL)
                                                                                                                            scan catalog_sales
                                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                                scan date_dim
                                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                                    remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                        scan item
                                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_847, i_category_id_851, i_class_id_849])
                                                                                                        intermediate aggregation over (i_brand_id_847, i_category_id_851, i_class_id_849)
                                                                                                            join (INNER, REPLICATED):
                                                                                                                partial aggregation over (ws_item_sk_803)
                                                                                                                    join (INNER, REPLICATED):
                                                                                                                        dynamic filter (ws_item_sk_803::EQUAL, ws_sold_date_sk_834::EQUAL)
                                                                                                                            scan web_sales
                                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                                scan date_dim
                                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                                    remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                        scan item
                                        local exchange (GATHER, SINGLE, [])
                                            remote exchange (REPLICATE, BROADCAST, [])
                                                final aggregation over ()
                                                    local exchange (GATHER, SINGLE, [])
                                                        remote exchange (GATHER, SINGLE, [])
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (ss_sold_date_sk_931::EQUAL)
                                                                        scan store_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (cs_sold_date_sk_1003::EQUAL)
                                                                        scan catalog_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (ws_sold_date_sk_1075::EQUAL)
                                                                        scan web_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                    cross join:
                                        final aggregation over (i_brand_id_1163, i_category_id_1167, i_class_id_1165)
                                            local exchange (GATHER, SINGLE, [])
                                                remote exchange (REPARTITION, HASH, [i_brand_id_1163, i_category_id_1167, i_class_id_1165])
                                                    intermediate aggregation over (i_brand_id_1163, i_category_id_1167, i_class_id_1165)
                                                        join (INNER, REPLICATED):
                                                            partial aggregation over (ws_item_sk_1119)
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (ws_item_sk_1119::EQUAL, ws_sold_date_sk_1150::EQUAL)
                                                                        scan web_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            local exchange (GATHER, SINGLE, [])
                                                                remote exchange (REPLICATE, BROADCAST, [])
                                                                    join (INNER, PARTITIONED):
                                                                        remote exchange (REPARTITION, HASH, [i_item_sk_1156])
                                                                            dynamic filter (i_item_sk_1156::EQUAL)
                                                                                scan item
                                                                        final aggregation over (i_item_sk_1218)
                                                                            local exchange (GATHER, SINGLE, [])
                                                                                remote exchange (REPARTITION, HASH, [i_item_sk_1218])
                                                                                    partial aggregation over (i_item_sk_1218)
                                                                                        join (INNER, PARTITIONED, can skip output duplicates):
                                                                                            remote exchange (REPARTITION, HASH, [i_brand_id_1225, i_category_id_1229, i_class_id_1227])
                                                                                                dynamic filter (i_brand_id_1225::EQUAL, i_category_id_1229::EQUAL, i_class_id_1227::EQUAL)
                                                                                                    scan item
                                                                                            final aggregation over (brand_id_1245, category_id_1247, class_id_1246)
                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_1286, i_category_id_1290, i_class_id_1288])
                                                                                                        intermediate aggregation over (i_brand_id_1286, i_category_id_1290, i_class_id_1288)
                                                                                                            join (INNER, REPLICATED):
                                                                                                                partial aggregation over (ss_item_sk_1252)
                                                                                                                    join (INNER, REPLICATED):
                                                                                                                        dynamic filter (ss_item_sk_1252::EQUAL, ss_sold_date_sk_1273::EQUAL)
                                                                                                                            scan store_sales
                                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                                scan date_dim
                                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                                    remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                        scan item
                                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_1385, i_category_id_1389, i_class_id_1387])
                                                                                                        intermediate aggregation over (i_brand_id_1385, i_category_id_1389, i_class_id_1387)
                                                                                                            join (INNER, REPLICATED):
                                                                                                                partial aggregation over (cs_item_sk_1353)
                                                                                                                    join (INNER, REPLICATED):
                                                                                                                        dynamic filter (cs_item_sk_1353::EQUAL, cs_sold_date_sk_1372::EQUAL)
                                                                                                                            scan catalog_sales
                                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                                scan date_dim
                                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                                    remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                        scan item
                                                                                                    remote exchange (REPARTITION, HASH, [i_brand_id_1484, i_category_id_1488, i_class_id_1486])
                                                                                                        intermediate aggregation over (i_brand_id_1484, i_category_id_1488, i_class_id_1486)
                                                                                                            join (INNER, REPLICATED):
                                                                                                                partial aggregation over (ws_item_sk_1440)
                                                                                                                    join (INNER, REPLICATED):
                                                                                                                        dynamic filter (ws_item_sk_1440::EQUAL, ws_sold_date_sk_1471::EQUAL)
                                                                                                                            scan web_sales
                                                                                                                        local exchange (GATHER, SINGLE, [])
                                                                                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                                scan date_dim
                                                                                                                local exchange (GATHER, SINGLE, [])
                                                                                                                    remote exchange (REPLICATE, BROADCAST, [])
                                                                                                                        scan item
                                        local exchange (GATHER, SINGLE, [])
                                            remote exchange (REPLICATE, BROADCAST, [])
                                                final aggregation over ()
                                                    local exchange (GATHER, SINGLE, [])
                                                        remote exchange (GATHER, SINGLE, [])
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (ss_sold_date_sk_1568::EQUAL)
                                                                        scan store_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (cs_sold_date_sk_1640::EQUAL)
                                                                        scan catalog_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
                                                            partial aggregation over ()
                                                                join (INNER, REPLICATED):
                                                                    dynamic filter (ws_sold_date_sk_1712::EQUAL)
                                                                        scan web_sales
                                                                    local exchange (GATHER, SINGLE, [])
                                                                        remote exchange (REPLICATE, BROADCAST, [])
                                                                            scan date_dim
