local exchange (GATHER, SINGLE, [])
    remote exchange (GATHER, SINGLE, [])
        local exchange (GATHER, SINGLE, [])
            local exchange (REPARTITION, ROUND_ROBIN, [])
                join (INNER, PARTITIONED):
                    join (INNER, PARTITIONED):
                        join (INNER, PARTITIONED):
                            final aggregation over (c_birth_country_573, c_customer_id_560, c_email_address_575, c_first_name_567, c_last_name_568, c_login_574, c_preferred_cust_flag_569, d_year_627)
                                local exchange (GATHER, SINGLE, [])
                                    remote exchange (REPARTITION, HASH, [c_customer_id_560])
                                        intermediate aggregation over (c_birth_country_573, c_customer_id_560, c_email_address_575, c_first_name_567, c_last_name_568, c_login_574, c_preferred_cust_flag_569, d_year_627)
                                            join (INNER, PARTITIONED):
                                                partial aggregation over (cs_bill_customer_sk_584, d_year_627)
                                                    remote exchange (REPARTITION, HASH, [cs_bill_customer_sk_584])
                                                        join (INNER, REPLICATED):
                                                            dynamic filter (cs_bill_customer_sk_584::EQUAL, cs_sold_date_sk_615::EQUAL)
                                                                scan catalog_sales
                                                            local exchange (GATHER, SINGLE, [])
                                                                remote exchange (REPLICATE, BROADCAST, [])
                                                                    scan date_dim
                                                local exchange (GATHER, SINGLE, [])
                                                    remote exchange (REPARTITION, HASH, [c_customer_sk_559])
                                                        dynamic filter (c_customer_id_560::EQUAL, c_customer_id_560::EQUAL, c_customer_id_560::EQUAL)
                                                            scan customer
                            final aggregation over (c_birth_country_1277, c_customer_id_1264, c_email_address_1279, c_first_name_1271, c_last_name_1272, c_login_1278, c_preferred_cust_flag_1273, d_year_1331)
                                local exchange (GATHER, SINGLE, [])
                                    remote exchange (REPARTITION, HASH, [c_customer_id_1264])
                                        intermediate aggregation over (c_birth_country_1277, c_customer_id_1264, c_email_address_1279, c_first_name_1271, c_last_name_1272, c_login_1278, c_preferred_cust_flag_1273, d_year_1331)
                                            join (INNER, PARTITIONED):
                                                partial aggregation over (d_year_1331, ws_bill_customer_sk_1289)
                                                    remote exchange (REPARTITION, HASH, [ws_bill_customer_sk_1289])
                                                        join (INNER, REPLICATED):
                                                            dynamic filter (ws_bill_customer_sk_1289::EQUAL, ws_sold_date_sk_1319::EQUAL)
                                                                scan web_sales
                                                            local exchange (GATHER, SINGLE, [])
                                                                remote exchange (REPLICATE, BROADCAST, [])
                                                                    scan date_dim
                                                local exchange (GATHER, SINGLE, [])
                                                    remote exchange (REPARTITION, HASH, [c_customer_sk_1263])
                                                        dynamic filter (c_customer_id_1264::EQUAL, c_customer_id_1264::EQUAL)
                                                            scan customer
                        final aggregation over (c_birth_country_183, c_customer_id_170, c_email_address_185, c_first_name_177, c_last_name_178, c_login_184, c_preferred_cust_flag_179, d_year_226)
                            local exchange (GATHER, SINGLE, [])
                                remote exchange (REPARTITION, HASH, [c_customer_id_170])
                                    intermediate aggregation over (c_birth_country_183, c_customer_id_170, c_email_address_185, c_first_name_177, c_last_name_178, c_login_184, c_preferred_cust_flag_179, d_year_226)
                                        join (INNER, PARTITIONED):
                                            partial aggregation over (d_year_226, ss_customer_sk_194)
                                                remote exchange (REPARTITION, HASH, [ss_customer_sk_194])
                                                    join (INNER, REPLICATED):
                                                        dynamic filter (ss_customer_sk_194::EQUAL, ss_sold_date_sk_214::EQUAL)
                                                            scan store_sales
                                                        local exchange (GATHER, SINGLE, [])
                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                scan date_dim
                                            local exchange (GATHER, SINGLE, [])
                                                remote exchange (REPARTITION, HASH, [c_customer_sk_169])
                                                    dynamic filter (c_customer_id_170::EQUAL)
                                                        scan customer
                    join (INNER, PARTITIONED):
                        join (INNER, PARTITIONED):
                            final aggregation over (c_birth_country_876, c_customer_id_863, c_email_address_878, c_first_name_870, c_last_name_871, c_login_877, c_preferred_cust_flag_872, d_year_930)
                                local exchange (GATHER, SINGLE, [])
                                    remote exchange (REPARTITION, HASH, [c_customer_id_863])
                                        intermediate aggregation over (c_birth_country_876, c_customer_id_863, c_email_address_878, c_first_name_870, c_last_name_871, c_login_877, c_preferred_cust_flag_872, d_year_930)
                                            join (INNER, PARTITIONED):
                                                partial aggregation over (cs_bill_customer_sk_887, d_year_930)
                                                    remote exchange (REPARTITION, HASH, [cs_bill_customer_sk_887])
                                                        join (INNER, REPLICATED):
                                                            dynamic filter (cs_bill_customer_sk_887::EQUAL, cs_sold_date_sk_918::EQUAL)
                                                                scan catalog_sales
                                                            local exchange (GATHER, SINGLE, [])
                                                                remote exchange (REPLICATE, BROADCAST, [])
                                                                    scan date_dim
                                                local exchange (GATHER, SINGLE, [])
                                                    remote exchange (REPARTITION, HASH, [c_customer_sk_862])
                                                        dynamic filter (c_customer_id_863::EQUAL, c_customer_id_863::EQUAL)
                                                            scan customer
                            final aggregation over (c_birth_country_1580, c_customer_id_1567, c_email_address_1582, c_first_name_1574, c_last_name_1575, c_login_1581, c_preferred_cust_flag_1576, d_year_1634)
                                local exchange (GATHER, SINGLE, [])
                                    remote exchange (REPARTITION, HASH, [c_customer_id_1567])
                                        intermediate aggregation over (c_birth_country_1580, c_customer_id_1567, c_email_address_1582, c_first_name_1574, c_last_name_1575, c_login_1581, c_preferred_cust_flag_1576, d_year_1634)
                                            join (INNER, PARTITIONED):
                                                partial aggregation over (d_year_1634, ws_bill_customer_sk_1592)
                                                    remote exchange (REPARTITION, HASH, [ws_bill_customer_sk_1592])
                                                        join (INNER, REPLICATED):
                                                            dynamic filter (ws_bill_customer_sk_1592::EQUAL, ws_sold_date_sk_1622::EQUAL)
                                                                scan web_sales
                                                            local exchange (GATHER, SINGLE, [])
                                                                remote exchange (REPLICATE, BROADCAST, [])
                                                                    scan date_dim
                                                local exchange (GATHER, SINGLE, [])
                                                    remote exchange (REPARTITION, HASH, [c_customer_sk_1566])
                                                        dynamic filter (c_customer_id_1567::EQUAL)
                                                            scan customer
                        final aggregation over (c_birth_country, c_customer_id, c_email_address, c_first_name, c_last_name, c_login, c_preferred_cust_flag, d_year)
                            local exchange (GATHER, SINGLE, [])
                                remote exchange (REPARTITION, HASH, [c_customer_id])
                                    intermediate aggregation over (c_birth_country, c_customer_id, c_email_address, c_first_name, c_last_name, c_login, c_preferred_cust_flag, d_year)
                                        join (INNER, PARTITIONED):
                                            partial aggregation over (d_year, ss_customer_sk)
                                                remote exchange (REPARTITION, HASH, [ss_customer_sk])
                                                    join (INNER, REPLICATED):
                                                        dynamic filter (ss_customer_sk::EQUAL, ss_sold_date_sk::EQUAL)
                                                            scan store_sales
                                                        local exchange (GATHER, SINGLE, [])
                                                            remote exchange (REPLICATE, BROADCAST, [])
                                                                scan date_dim
                                            local exchange (GATHER, SINGLE, [])
                                                remote exchange (REPARTITION, HASH, [c_customer_sk])
                                                    scan customer
